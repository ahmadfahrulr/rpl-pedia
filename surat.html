<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pembuat Surat Lamaran Kerja Otomatis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Style untuk textarea dan tombol disabled */
        textarea::placeholder {
            color: #9ca3af;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-4">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">Pembuat Surat Lamaran Otomatis</h1>
            <p id="sub-header" class="text-md sm:text-lg text-gray-600 mt-2">Isi formulir di sebelah kiri, dan lihat pratinjau surat Anda secara langsung di sebelah kanan.</p>
        </header>

        <div class="mb-6 text-left">
             <a href="index.html" class="inline-flex items-center justify-center px-4 py-2 text-sm font-semibold text-white bg-gray-600 rounded-lg hover:bg-gray-700 transition-colors shadow-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                </svg>
                Kembali
            </a>
        </div>

        <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Kolom Form Input -->
            <div id="form-section" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border border-gray-200 fade-in">
                <form id="form-lamaran" class="space-y-4">
                    <h2 class="text-2xl font-semibold mb-4 border-b pb-3">Informasi Anda</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="nama" class="block text-sm font-medium text-gray-700 mb-1">Nama Lengkap</label>
                            <input type="text" id="nama" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: Budi Santoso" required>
                        </div>
                        <div>
                            <label for="kota" class="block text-sm font-medium text-gray-700 mb-1">Kota Domisili (di kop surat)</label>
                            <input type="text" id="kota" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: Jakarta" required>
                        </div>
                    </div>
                     <div>
                        <label for="alamat" class="block text-sm font-medium text-gray-700 mb-1">Alamat Lengkap (di identitas)</label>
                        <input type="text" id="alamat" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: Jl. Merdeka No. 10, Jakarta" required>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="telepon" class="block text-sm font-medium text-gray-700 mb-1">Nomor Telepon</label>
                            <input type="tel" id="telepon" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: 081234567890" required>
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" id="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: budi.santoso@email.com" required>
                        </div>
                    </div>

                    <h2 class="text-2xl font-semibold pt-6 mb-4 border-b pb-3">Informasi Perusahaan</h2>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="nama_perusahaan" class="block text-sm font-medium text-gray-700 mb-1">Nama Perusahaan</label>
                            <input type="text" id="nama_perusahaan" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: PT. Maju Jaya" required>
                        </div>
                         <div>
                            <label for="posisi" class="block text-sm font-medium text-gray-700 mb-1">Posisi yang Dilamar</label>
                            <input type="text" id="posisi" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: Staff Administrasi" required>
                        </div>
                    </div>
                     <div>
                        <label for="nama_hrd" class="block text-sm font-medium text-gray-700 mb-1">Nama Manajer HRD (opsional)</label>
                        <input type="text" id="nama_hrd" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: Bapak/Ibu HRD">
                    </div>
                </form>
            </div>

            <!-- Kolom Pratinjau Real-time -->
            <div id="preview-section" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border border-gray-200 fade-in">
                 <h2 class="text-2xl font-semibold mb-6 border-b pb-3">Pratinjau Surat Lamaran</h2>
                 <div class="bg-gray-50 p-4 rounded-lg border">
                    <textarea id="hasil-surat" class="w-full h-96 p-2 border-none rounded-md bg-gray-50 text-gray-700 leading-relaxed focus:outline-none" placeholder="Pratinjau surat akan muncul di sini saat Anda mengisi formulir." readonly></textarea>
                 </div>
                 <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6">
                     <button id="unduh-doc" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300">
                        Unduh (.doc)
                    </button>
                    <button id="salin-teks" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition duration-300">
                        Salin Teks
                    </button>
                </div>
                <p id="pesan-salin" class="text-center text-green-600 font-medium mt-4 h-4"></p>
            </div>
        </main>
        
        <footer class="text-center mt-12 py-4">
            <!-- Footer content removed -->
        </footer>
    </div>

    <script>
        // Ambil elemen dari DOM
        const formLamaran = document.getElementById('form-lamaran');
        const hasilSurat = document.getElementById('hasil-surat');
        const salinTeksBtn = document.getElementById('salin-teks');
        const unduhDocBtn = document.getElementById('unduh-doc');
        const pesanSalin = document.getElementById('pesan-salin');
        
        // Cek semua input yang wajib diisi
        const requiredInputs = formLamaran.querySelectorAll('input[required]');

        // Fungsi untuk memeriksa validitas form
        const checkFormValidity = () => {
            let allFilled = true;
            requiredInputs.forEach(input => {
                if (input.value.trim() === '') {
                    allFilled = false;
                }
            });
            // Aktifkan/nonaktifkan tombol berdasarkan validitas
            salinTeksBtn.disabled = !allFilled;
            unduhDocBtn.disabled = !allFilled;
        };

        // Fungsi untuk membuat konten surat secara real-time
        const generateSurat = () => {
            checkFormValidity();

            const nama = document.getElementById('nama').value;
            const kota = document.getElementById('kota').value;
            const alamat = document.getElementById('alamat').value;
            const telepon = document.getElementById('telepon').value;
            const email = document.getElementById('email').value;
            const namaPerusahaan = document.getElementById('nama_perusahaan').value;
            const posisi = document.getElementById('posisi').value;
            let namaHrd = document.getElementById('nama_hrd').value || "Bapak/Ibu Pimpinan HRD";

            if (!nama && !kota && !alamat && !telepon && !email && !namaPerusahaan && !posisi) {
                hasilSurat.value = ''; // Kosongkan jika form bersih
                return;
            }

            const tanggal = new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });

            const templateSurat = `
${kota || '[Kota Anda]'}, ${tanggal}

Kepada Yth.
${namaHrd}
${namaPerusahaan || '[Nama Perusahaan]'}
di Tempat

Dengan hormat,

Berdasarkan informasi yang saya peroleh, bahwa ${namaPerusahaan || '[Nama Perusahaan]'} sedang membuka lowongan pekerjaan untuk posisi ${posisi || '[Posisi yang Dilamar]'}. Sehubungan dengan hal tersebut, saya yang bertanda tangan di bawah ini:

Nama: ${nama || '[Nama Lengkap]'}
Alamat: ${alamat || '[Alamat Lengkap Anda]'}
No. Telepon: ${telepon || '[Nomor Telepon]'}
Email: ${email || '[Email Anda]'}

Bermaksud untuk mengajukan lamaran pekerjaan pada posisi tersebut. Saya memiliki minat yang besar pada posisi ini dan yakin dapat memberikan kontribusi terbaik bagi perusahaan.

Sebagai bahan pertimbangan, saya lampirkan beberapa dokumen pendukung. Saya sangat berharap dapat diberikan kesempatan untuk mengikuti tahap wawancara agar dapat menjelaskan lebih lanjut mengenai potensi dan kemampuan yang saya miliki.

Demikian surat lamaran ini saya buat. Atas perhatian Bapak/Ibu, saya ucapkan terima kasih.

Hormat saya,


${nama || '[Nama Lengkap]'}
            `;
            
            hasilSurat.value = templateSurat.trim();
        };
        
        // Event listener untuk update real-time saat pengguna mengetik
        formLamaran.addEventListener('input', generateSurat);

        // Event listener dan fungsi untuk menyalin teks
        salinTeksBtn.addEventListener('click', function() {
            hasilSurat.select();
            hasilSurat.setSelectionRange(0, 99999); // Untuk perangkat mobile
            try {
                document.execCommand('copy');
                pesanSalin.textContent = 'Teks berhasil disalin!';
            } catch (err) {
                pesanSalin.textContent = 'Gagal menyalin teks.';
                console.error('Gagal menyalin: ', err);
            }
            setTimeout(() => { pesanSalin.textContent = ''; }, 3000);
        });

        // Event listener dan fungsi untuk mengunduh dokumen
        unduhDocBtn.addEventListener('click', function() {
            const namaFile = `Surat Lamaran - ${document.getElementById('nama').value || 'Pelamar'}.doc`;
            const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Surat Lamaran</title></head><body>";
            const footer = "</body></html>";
            const content = hasilSurat.value.replace(/\n/g, '<br>');
            const sourceHTML = header + `<div style="font-family: 'Times New Roman', Times, serif; font-size: 12pt;">${content}</div>` + footer;

            const source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
            const fileDownload = document.createElement("a");
            document.body.appendChild(fileDownload);
            fileDownload.href = source;
            fileDownload.download = namaFile;
            fileDownload.click();
            document.body.removeChild(fileDownload);

            pesanSalin.textContent = 'Dokumen berhasil diunduh!';
            setTimeout(() => { pesanSalin.textContent = ''; }, 3000);
        });
        
        // Panggil fungsi saat halaman pertama kali dimuat untuk set state tombol
        checkFormValidity();

    </script>

</body>
</html>
